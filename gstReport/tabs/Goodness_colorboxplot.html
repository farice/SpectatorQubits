        <h1>Model violation for each individual circuit</h1>
<p>This tab presents the second of two statistical tests available to detect that a dataset violates pyGSTi's Markovian gateset model.  The first is based on the <em>aggregate</em> loglikelihood score presented elsewhere.  This tab shows the <em>individual</em> loglikelihood scores for each circuit in the dataset.  Each circuit is represented by a colored box, whose color indicates how badly this estimate (model) failed to predict the observed outcome frequencies of that circuit.  Light gray indicates consistency with the model, dark gray indicates possible -- but statistically insignificant -- inconsistency, and red squares indicate circuits whose outcomes are inconsistent with the model at the <em>family-wise</em>  95 percent confidence level.  In other words, if data are generated by a Markovian gateset, then with 95% probability <em>every</em> box will be gray.  Even a single red square thus represents a clear detection of model violation.  When many squares are red, their pattern can provide useful diagnostic clues to what kind of non-Markovian noise is present.</p>
	<figure id="bestEstimateColorBoxPlot">
	  <script>
  $(document).ready(function() {
var switchmap_plot_6031 = new Array();
switchmap_plot_6031[ [0,1,0] ] = 'plot_6031_3';
switchmap_plot_6031[ [0,0,2] ] = 'plot_6031_2';
switchmap_plot_6031[ [0,1,1] ] = 'plot_6031_4';
switchmap_plot_6031[ [0,0,1] ] = 'plot_6031_1';
switchmap_plot_6031[ [0,1,2] ] = 'plot_6031_5';
switchmap_plot_6031[ [0,0,0] ] = 'plot_6031_0';
window.switchmap_plot_6031 = switchmap_plot_6031;

function connect_plot_6031_to_switches(){
  if($('#switchbd7797_0').hasClass('initializedSwitch') && $('#switchbd7797_1').hasClass('initializedSwitch') && $('#switchbd7797_3').hasClass('initializedSwitch')) {
    $('#switchbd7797_0').on('selectmenuchange', function() {plot_6031_onchange(); });
    $('#switchbd7797_1').on('selectmenuchange', function() {plot_6031_onchange(); });
    $('#switchbd7797_3').on('slidechange', function() {plot_6031_onchange(); });
    $( '#plot_6031' ).closest('.tabcontent').on('tabchange', function(){
plot_6031_onchange(); });
    plot_6031_onchange();
    console.log('Switches initialized: plot_6031 handlers set');
    $( '#plot_6031' ).show()
  }
  else {
    setTimeout(connect_plot_6031_to_switches, 500);
    console.log('plot_6031 switches NOT initialized: Waiting...');
  }
};
$(document).ready(function() {
  connect_plot_6031_to_switches();
});

function plot_6031_onchange() {
  var tabdiv = $( '#plot_6031' ).closest('.tabcontent');
  if( tabdiv.length > 0 && !tabdiv.hasClass('active') ) return;
  var curSwitchPos = new Array();
  curSwitchPos.push($('#switchbd7797_0').val());
  curSwitchPos.push($('#switchbd7797_1').val());
  curSwitchPos.push(findNearest_switchbd7797_3(true,true,$('#switchbd7797_3').slider('option', 'value')));
  var idToShow = switchmap_plot_6031[ curSwitchPos ];
  $( '#plot_6031' ).children().hide();
  divToShow = $( '#' + idToShow );
  if( divToShow.children().length == 0 ) {
    loadLocal('figures/' + idToShow + '.html', '#' + idToShow, function() {
        divToShow = $( '#' + idToShow );
        divToShow.show();
        divToShow.parentsUntil('#plot_6031').show();
        caption = divToShow.closest('figure').children('figcaption:first');
        caption.css('width', Math.round(divToShow.width()*0.9) + 'px');
    });
  }
  else {
    divToShow.show();
    divToShow.parentsUntil('#plot_6031').show();
    caption = divToShow.closest('figure').children('figcaption:first');
    caption.css('width', Math.round(divToShow.width()*0.9) + 'px');
  }
}
make_wsplot_resizable("plot_6031");
}); //end on-ready handler

</script>

<div id='plot_6031' class='pygsti-wsoutput-group'>
<div class='single_switched_value bot_relwrap' id='plot_6031_0'></div>

<div class='single_switched_value bot_relwrap' id='plot_6031_1'></div>

<div class='single_switched_value bot_relwrap' id='plot_6031_2'></div>

<div class='single_switched_value bot_relwrap' id='plot_6031_3'></div>

<div class='single_switched_value bot_relwrap' id='plot_6031_4'></div>

<div class='single_switched_value bot_relwrap' id='plot_6031_5'></div>

</div>

	  <script>
$(document).ready(function() {
  $('#switchbd7797_0v6').selectmenu();function connect_switchbd7797_0v6_to_base(){
  if( $('#switchbd7797_0').hasClass('initializedSwitch') ) {
    $('#switchbd7797_0').on('selectmenuchange', function(event, ui) {
      var v = $('#switchbd7797_0').val();
      var el = $('#switchbd7797_0v6');
      if( el.val() != v ) { 
        el.val(v).selectmenu('refresh');
      }
    });    $('#switchbd7797_0v6').on('selectmenuchange', function(event, ui) {
      var v = $('#switchbd7797_0v6').val();
      var el = $('#switchbd7797_0');
      if( el.val() != v ) { 
        el.val(v).selectmenu('refresh').trigger('selectmenuchange');
      }
    });
    $('#switchbd7797_0').trigger('selectmenuchange');
    console.log('switchbd7797_0v6 connected to base');

  }
  else {
    setTimeout(connect_switchbd7797_0v6_to_base, 500);
    console.log('switchbd7797_0v6 base NOT initialized: Waiting...');
  }
};
connect_switchbd7797_0v6_to_base();$('#switchbd7797_0v6').addClass('initializedSwitch');

  $('#switchbd7797_1v6').selectmenu();function connect_switchbd7797_1v6_to_base(){
  if( $('#switchbd7797_1').hasClass('initializedSwitch') ) {
    $('#switchbd7797_1').on('selectmenuchange', function(event, ui) {
      var v = $('#switchbd7797_1').val();
      var el = $('#switchbd7797_1v6');
      if( el.val() != v ) { 
        el.val(v).selectmenu('refresh');
      }
    });    $('#switchbd7797_1v6').on('selectmenuchange', function(event, ui) {
      var v = $('#switchbd7797_1v6').val();
      var el = $('#switchbd7797_1');
      if( el.val() != v ) { 
        el.val(v).selectmenu('refresh').trigger('selectmenuchange');
      }
    });
    $('#switchbd7797_1').trigger('selectmenuchange');
    console.log('switchbd7797_1v6 connected to base');

  }
  else {
    setTimeout(connect_switchbd7797_1v6_to_base, 500);
    console.log('switchbd7797_1v6 base NOT initialized: Waiting...');
  }
};
connect_switchbd7797_1v6_to_base();$('#switchbd7797_1v6').addClass('initializedSwitch');

  $('#switchbd7797_2v6 > input').checkboxradio({ icon: false });function connect_switchbd7797_2v6_to_base(){
  if( $('#switchbd7797_2').hasClass('initializedSwitch') ) {
    $('#switchbd7797_2').on('change', function(event, ui) {
      var v = $("#switchbd7797_2 > input[name='switchbd7797_2']:checked").val();
      var el = $("#switchbd7797_2v6 > input[name='switchbd7797_2v6'][value=" + v + "]");
      if( el.is(':checked') == false ) { 
        el.click();
      }
    });    $('#switchbd7797_2v6').on('change', function(event, ui) {
      var v = $("#switchbd7797_2v6 > input[name='switchbd7797_2v6']:checked").val();
      var el = $("#switchbd7797_2 > input[name='switchbd7797_2'][value=" + v + "]");
      if( el.is(':checked') == false ) { 
        el.click();
      }
    });
    $('#switchbd7797_2').trigger('change');
  }
  else {
    setTimeout(connect_switchbd7797_2v6_to_base, 500);
    console.log('switchbd7797_2v6 base NOT initialized: Waiting...');
  }
};
connect_switchbd7797_2v6_to_base();$('#switchbd7797_2v6').addClass('initializedSwitch');

  $('#switchbd7797_3v6').slider({
     orientation: 'horizontal', range: false,
     min: 0.000000, max: 2.000000, step: 0.020000,
     value: 2.000000,
     create: function() {
       $('#switchbd7797_3v6-handle').text('4');
       $('#switchbd7797_3v6-handle').css({'width':'3.000000em','height':'1.700000em'});
       $('#switchbd7797_3v6-handle').css({'margin-left':'-1.500000em','top':'-0.450000em'});
       $('#switchbd7797_3v6-handle').css({'text-align':'center','line-height':'1.5em'});
       $('#switchbd7797_3v6').css({'margin-left':'1.500000em', 'margin-top':'0.4em'});
     },
     slide: function(event, ui) {
        var includeLeft = event.keyCode != $.ui.keyCode.RIGHT;
        var includeRight = event.keyCode != $.ui.keyCode.LEFT;
        var iValue = findNearest_switchbd7797_3(includeLeft, includeRight, ui.value);
        if($('#switchbd7797_3v6').slider('value') != switchbd7797_3_float_values[iValue]) {
          $('#switchbd7797_3-handle').text(switchbd7797_3_str_values[iValue]);
          $('#switchbd7797_3').slider('value', switchbd7797_3_float_values[iValue]);
        }        return false;    },
  });function connect_switchbd7797_3v6_to_base(){
  if( $('#switchbd7797_3').hasClass('initializedSwitch') ) {
    $('#switchbd7797_3').on('slidechange', function(event, ui) {
      $('#switchbd7797_3v6').slider('value', ui.value);
      $('#switchbd7797_3v6-handle').text( $('#switchbd7797_3-handle').text() );
      });
    var mock_ui = { value: $('#switchbd7797_3').slider('value') };
    $('#switchbd7797_3').trigger('slidechange', mock_ui);
  }
  else {
    setTimeout(connect_switchbd7797_3v6_to_base, 500);
    console.log('switchbd7797_3v6 base NOT initialized: Waiting...');
  }
};
connect_switchbd7797_3v6_to_base();$('#switchbd7797_3v6').addClass('initializedSwitch');

});
</script>

<div class='switch_container' style='display: none'><fieldset>
<label for='switchbd7797_0v6'>Dataset</label>
<select name='switchbd7797_0v6' id='switchbd7797_0v6'>
<option value=0 selected='selected'>unique</option>
</select>
</fieldset></div>

<div class='switch_container' style='display: none'><fieldset>
<label for='switchbd7797_1v6'>Estimate</label>
<select name='switchbd7797_1v6' id='switchbd7797_1v6'>
<option value=0 selected='selected'>TP</option>
<option value=1>Target</option>
</select>
</fieldset></div>

<div class='switch_container' style='display: none'>
<fieldset id='switchbd7797_2v6'>
<legend>Gauge-Opt: </legend>
<label for='switchbd7797_2v6-0'>single</label>
<input type='radio' name='switchbd7797_2v6' id='switchbd7797_2v6-0' value=0 checked='checked'>
</fieldset></div>

<div id='switchbd7797_3v6-container' class='switch_container'>
<fieldset>
<label for='switchbd7797_3v6' class='pygsti-slider-label'>max(L)</label>
<div name='switchbd7797_3v6' id='switchbd7797_3v6'>
<div id='switchbd7797_3v6-handle' class='ui-slider-handle'></div></div>
</fieldset></div>

	  <figcaption><span class="captiontitle">Per-sequence model violation box plot.</span><span class="captiondetail"> This plot shows the <span class="math">2\Delta\log(\mathcal{L})</span> contribution for each individual circuit in the dataset.  Each box represents a single gate sequence, and its color indicates whether GST was able to fit the corresponding frequency well.  Shades of white/gray indicate typical (within the expected) values. Red squares represent statistically significant evidence for model violation (non-Markovianity), and the probabilty that <i>any</i> red squares appear is 5% when the data really are Markovian. Each square block of pixels (<q>plaquette</q>) corresponds to a particular germ-power "base sequence", and each pixel within a block corresponds to a specific "fiducial pair" -- i.e., choice of pre- and post-fiducial sequences.  The base sequences are arranged by germ (varying from row to row), and by power/length (varying from column to column).  Hovering over a colored box will pop up the exact circuit to which it corresponds, the observed frequencies, and the corresponding probabilities predicted by the GST estimate of the gateset.  The slider below the figure permits switching between different estimates, labeled by <span class="math">L</span>, which were obtained from subsets of the data that included only base sequences of length up to <span class="math">L</span>. </span></figcaption>
	</figure>


	<figure id="bestEstimateTVDColorBoxPlot">
	  <script>
  $(document).ready(function() {
var switchmap_plot_6526 = new Array();
switchmap_plot_6526[ [0,1,0] ] = 'plot_6526_3';
switchmap_plot_6526[ [0,0,2] ] = 'plot_6526_2';
switchmap_plot_6526[ [0,1,1] ] = 'plot_6526_4';
switchmap_plot_6526[ [0,0,1] ] = 'plot_6526_1';
switchmap_plot_6526[ [0,1,2] ] = 'plot_6526_5';
switchmap_plot_6526[ [0,0,0] ] = 'plot_6526_0';
window.switchmap_plot_6526 = switchmap_plot_6526;

function connect_plot_6526_to_switches(){
  if($('#switchbd7797_0').hasClass('initializedSwitch') && $('#switchbd7797_1').hasClass('initializedSwitch') && $('#switchbd7797_3').hasClass('initializedSwitch')) {
    $('#switchbd7797_0').on('selectmenuchange', function() {plot_6526_onchange(); });
    $('#switchbd7797_1').on('selectmenuchange', function() {plot_6526_onchange(); });
    $('#switchbd7797_3').on('slidechange', function() {plot_6526_onchange(); });
    $( '#plot_6526' ).closest('.tabcontent').on('tabchange', function(){
plot_6526_onchange(); });
    plot_6526_onchange();
    console.log('Switches initialized: plot_6526 handlers set');
    $( '#plot_6526' ).show()
  }
  else {
    setTimeout(connect_plot_6526_to_switches, 500);
    console.log('plot_6526 switches NOT initialized: Waiting...');
  }
};
$(document).ready(function() {
  connect_plot_6526_to_switches();
});

function plot_6526_onchange() {
  var tabdiv = $( '#plot_6526' ).closest('.tabcontent');
  if( tabdiv.length > 0 && !tabdiv.hasClass('active') ) return;
  var curSwitchPos = new Array();
  curSwitchPos.push($('#switchbd7797_0').val());
  curSwitchPos.push($('#switchbd7797_1').val());
  curSwitchPos.push(findNearest_switchbd7797_3(true,true,$('#switchbd7797_3').slider('option', 'value')));
  var idToShow = switchmap_plot_6526[ curSwitchPos ];
  $( '#plot_6526' ).children().hide();
  divToShow = $( '#' + idToShow );
  if( divToShow.children().length == 0 ) {
    loadLocal('figures/' + idToShow + '.html', '#' + idToShow, function() {
        divToShow = $( '#' + idToShow );
        divToShow.show();
        divToShow.parentsUntil('#plot_6526').show();
        caption = divToShow.closest('figure').children('figcaption:first');
        caption.css('width', Math.round(divToShow.width()*0.9) + 'px');
    });
  }
  else {
    divToShow.show();
    divToShow.parentsUntil('#plot_6526').show();
    caption = divToShow.closest('figure').children('figcaption:first');
    caption.css('width', Math.round(divToShow.width()*0.9) + 'px');
  }
}
make_wsplot_resizable("plot_6526");
}); //end on-ready handler

</script>

<div id='plot_6526' class='pygsti-wsoutput-group'>
<div class='single_switched_value bot_relwrap' id='plot_6526_0'></div>

<div class='single_switched_value bot_relwrap' id='plot_6526_1'></div>

<div class='single_switched_value bot_relwrap' id='plot_6526_2'></div>

<div class='single_switched_value bot_relwrap' id='plot_6526_3'></div>

<div class='single_switched_value bot_relwrap' id='plot_6526_4'></div>

<div class='single_switched_value bot_relwrap' id='plot_6526_5'></div>

</div>

	  <figcaption><span class="captiontitle">Per-sequence total variational distance box plot.</span><span class="captiondetail"> This plot shows the total variational distance (<span class="math">\frac{1}{2}\sum_i|p_i-f_i|</span>) contribution for each individual circuit in the dataset.  Each box represents a single gate sequence, and its color indicates how well the observed frequency matches the probability generated by GST's best-estimate gate set.  Each square block of pixels (<q>plaquette</q>) corresponds to a particular germ-power "base sequence", and each pixel within a block corresponds to a specific "fiducial pair" -- i.e., choice of pre- and post-fiducial sequences.  The base sequences are arranged by germ (varying from row to row), and by power/length (varying from column to column).  Hovering over a colored box will pop up the exact circuit to which it corresponds, the observed frequencies, and the corresponding probabilities predicted by the GST estimate of the gateset.  The slider below the figure permits switching between different estimates, labeled by <span class="math">L</span>, which were obtained from subsets of the data that included only base sequences of length up to <span class="math">L</span>. </span></figcaption>
	</figure>
